var $enums=$enums||{},$pluginApp;(function(n){n.items=[];n.find=function(t,i){var r=n.items.find(function(n){return n.name==t});if(typeof i=="undefined")return r;if(!r)return i;return r.items.find(function(n){return n.value===i||n.name===i})}})($enums||($enums={}));$groupCache={};$pluginApp=angular.module("pluginApp",["ui.bootstrap","chart.js","ngRoute","gc.bootstrap.modal"]).filter("enums",function(){return function(n,t){var i=$enums.find(t,n);return i?i.displayName:n}}).filter("group",function(){return function(n,t){var i,r,f,u;if(!n)return null;if(i=[],angular.forEach(n,function(n){i.push(n.name)}),i=i.join("-")+"-"+t,$groupCache[i])return $groupCache[i];if(r=[],f=[],n.length<t)r=[n];else for(u=0;u<n.length;u++)u%t==0&&(f=[],r.push(f)),f.push(n[u]);return $groupCache[i]=r,r}}).service("pluginService",["$http","$location",function(){var n=function(n,t){for(var i=n.length-1;i>=0;i--)if(n[i].name==t)return n[i];return n[0]},t=[],i,r;this.plugin=$plugin;this.registerObserverCallback=function(n){t.push(n)};i=function(){angular.forEach(t,function(n){n()})};this.setCurrent=function(t){var i=/\/category\/([^\/]*)(\/item\/([^\/]*))?/.exec(t),u,r;i!=null?(u=i[1],r=i[3],this.category=n(this.plugin.categories,u),this.item=this.category&&r?n(this.category.items,r):null):(this.category=null,this.item=null)};r=this;this.init=function(n){this.setCurrent(n);i()}}]).controller("baseController",["$scope","$http","$location","$templateCache","pluginService",function(n,t,i,r,u){function f(){n.plugins=u.plugins;n.plugin=u.plugin;n.category=u.category;n.item=u.item}n.$enums=$enums;var e=function(n,t){var u,r,i;if(!n)return null;if(n.length<=t)return[n];for(u=[],r=[],i=0;i<n.length;i++)i%t==0&&(r=[],u.push(r)),r.push(n[i]);return u};f();u.registerObserverCallback(f)}]).controller("navController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r,u){r("baseController",{$scope:n});n.plugins=u.plugins;n.plugin=u.plugin;n.setCategory=function(n){u.category=n};n.setItem=function(n){u.item=n}}]).controller("pluginController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("baseController",{$scope:n})}]).controller("categoryController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("baseController",{$scope:n})}]).controller("apiController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("baseController",{$scope:n});n.params={};n.beforeFetch=function(){};n.loadingText="Loading...";var u=function(r){var f,u;n.code=null;n.response=null;f=[];for(u in n.params)n.params[u]&&f.push(u+"="+n.params[u]);n.loading=!0;t.post("/api/plugins",{pluginName:n.plugin.name,categoryName:n.category?n.category.name:null,itemName:n.item.name,method:r,content:n.params},{responseType:"json",cache:i}).then(function(t){n.loading=!1;n.status=t.status;n.data=t.data},function(t){n.loading=!1;n.data=t.data||"Request failed";n.status=t.status})};n._fetch=function(){n.loadingText="Loading...";u("Read")};n._update=function(){n.loadingText="Updating...";u("Update")};n._delete=function(){n.loadingText="Deleting...";u("Delete")}}]).controller("pluginsController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("apiController",{$scope:n})}]).controller("tableController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("apiController",{$scope:n});n.maxShowPages=7;n.params.pageSize=10;n.pageSizeList=[5,10,20,50];n.beforeFetch=function(){};n.onPageChange=function(){n._fetch()};n.onPageSizeChange=function(t){n.params.pageSize=t;n._fetch()};n.updateModel=function(t,i){n.method=t;n.url=i};n.open=function(t){n.raw=t;n.showModal=!0};n.save=function(){n.params.raw=JSON.stringify(n.raw);n._update();n.showModal=!1};n.delete=function(){n.params.raw=JSON.stringify(n.raw);n._delete();n.showModel=!1};n.cancel=function(){n.showModal=!1};n._fetch()}]).controller("formController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("apiController",{$scope:n});n.updateData=function(){n.params.data=JSON.stringify(n.data);n._update()};n._fetch()}]).controller("chartController",["$scope","$http","$templateCache","$controller","pluginService",function(n,t,i,r){r("apiController",{$scope:n});n._fetch()}]).config(["$routeProvider",function(n){$plugin&&$plugin.categories&&$plugin.categories.forEach(function(t){n.when("/category/"+t.name,{templateUrl:"/plugins/_templates/views/category.html",controller:"categoryController"});t.items&&t.items.forEach(function(i){n.when("/category/"+t.name+"/item/"+i.name,{templateUrl:"/plugins/_templates/views/"+i.type+".html",controller:i.controller})})});n.otherwise({templateUrl:"/plugins/_templates/views/plugin.html",controller:"pluginController"})}]).run(["$rootScope","$location","$http","pluginService",function(n,t,i,r){n.$on("$routeChangeStart",function(){r.init(t.path())});r.init(t.path())}]);